<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="stylesheet" href="../src/Files/Style.css" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
      integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
      integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
      crossorigin="anonymous"
    ></script>
    <title>Ranjan</title>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
  <script>
    const canvas = document.getElementById("canvas");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const ctx = canvas.getContext("2d");

    let numBalls = 50,
      numColors = 4,
      colors = [],
      ballRadius = 10,
      constantRadius = false,
      balls = [];

    const mouse = {
      x: null,
      y: null,
      radius: 200,
    };

    canvas.onmousemove = (e) => {
      mouse.x = e.x;
      mouse.y = e.y;
    };

    //create ball object
    class Ball {
      constructor(x, y, radius, color) {
        this.x = x;
        this.y = y;
        this.radius = radius;
        this.baseX = this.x;
        this.baseY = this.y;
        this.color = color;
        this.density = Math.random() * 30 + 1;
      }
      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);
        ctx.fillStyle = this.color;
        ctx.fill();
      }

      update() {
        let disX = mouse.x - this.x;
        let disY = mouse.y - this.y;

        //distance between mouse and ball
        let distance = Math.sqrt(Math.pow(disX, 2) + Math.pow(disY, 2));

        //normalize r
        let dirX = disX / distance;
        let dirY = disY / distance;

        let friction = (mouse.radius - distance) / mouse.radius;

        let directionX = friction * dirX * this.density;
        let directionY = friction * dirY * this.density;

        if (distance < mouse.radius) {
          // this.accX = force.x;
          // this.accY = force.y;
          this.x -= directionX;
          this.y -= directionY;
        } else {
          if (this.x != this.baseX) {
            let drx = this.x - this.baseX;
            this.x -= drx / 18;
          }
          if (this.y != this.baseY) {
            let dry = this.y - this.baseY;
            this.y -= dry / 18;
          }
        }
      }
    }

    const init = () => {
      for (let i = 0; i < numColors; i++) {
        colors.push(generateRandomColor());
      }

      for (let i = 0; i < numBalls; i++) {
        let r = constantRadius
          ? ballRadius
          : Math.floor(Math.random() * ballRadius) + 1;
        let x = Math.floor(Math.random() * (canvas.width - 2 * r)) + r;
        let y = Math.floor(Math.random() * (canvas.height - 2 * r)) + r;
        let color = colors[Math.floor(Math.random() * colors.length) + 1];

        balls.push(new Ball(x, y, r, color));
      }
    };

    const generateRandomColor = () => {
      const randomColor =
        "#" + Math.floor(Math.random() * 16777215).toString(16);
      return randomColor;
    };

    const randomizeAll = () => {
      numBalls = Math.floor(Math.random() * 50) + 1;
      ballRadius = Math.floor(Math.random() * 5) + 1;
      constantRadius = Math.random() >= 0.5;
      balls = [];
      colors = [];
      init();
    };

    window.onresize = () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      randomizeAll();
    };

    const animate = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      for (let i = 0; i < balls.length; i++) {
        balls[i].draw();
        balls[i].update();
      }

      requestAnimationFrame(animate);
    };

    init();
    animate();
  </script>
</html>
